{% extends "base.html" %}
{% load url from future %}
{% load tags %}
{% block content %}
<style>
  .datepicker {
  display:inline-block;
  }
</style>
<!-- Underscore.js Templates -->
<script>
AIRPORTS_API_URL = "{% url 'api_dispatch_list' api_name="general" resource_name="airports" %}";
TORNADO_API_URL = "{% tornado_api_url %}";
</script>

<script type="text/template" id="tpl-waiting-search">
  
 	<div class="general-design" id="loading-page">
 	
 		<h1>Sökning pågår!</h1>
 		
 		<p>Vi söker just nu igenom nätets olika resebyråer för att hitta just rätt resa för dig. Sökningen tar ungefär 20sekunder.</p>
 		
 		<div class="progress progress-striped active" style="width:500px;">
	 			<div class="bar" id="current-progress-bar" style="width: 5%;"></div>
  		</div>
 	
 	</div>
</script>


<script type="text/template" id="tpl-overlay">
	
	<div class="modal fade hide" id="overlay-modal">
		
		  <div class="modal-header">
			    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
			    <h3 id="myModalLabel">Detaljerad information om din resa</h3>
			  </div>
			  <div class="modal-body">
			    <div class="modal-utresa">
			    <h3>Utresa</h3>
				    <span class="going-bold travel-header"><%= outbound['departure-where-name'] %> - <%= outbound['arrival-where-name'] %></span>
				    <span class="date-header"><%= outbound['departure-when'].substr(0, 10) %></span>
				    <hr class="soften" style="margin:25px 0px;">
				    <p style="margin-bottom:10px;">Avgår: <%= dayOfOutboundDeparture %> <%= outbound['departure-when'].substr(0, 10) %>	</p>
	
				   
				    
				    <!-- 		Loopar delresorna efter antalet totala stop		     -->
				<% var nrStopsOut = parseInt(outbound['stops']) %>
				    <% for (var i=0;i<nrStopsOut+1;i++){ %>
	   					<% if(nrStopsOut != 0 ){ %>
	   					<p class="going-bold">Delresa <%= i + 1 %>: </p> 
	   					<% } else{ }%>
	   					
	   					
					    <p class="going-bold"><%= outbound.trips[i]['departure-where-name'] %> - <%= outbound.trips[i]['arrival-where-name'] %></p>
					    
					    
					    
					    <span class="more-info"><%= outbound.trips[i]['departure-where-name'] %>, <%= outbound.trips[i]['departure-where-code'] %> <br>
					     <%= outbound.trips[i]['departure-when'].substr(0,10) %> <%= outbound.trips[i]['departure-when'].substr(11,5) %></span> 
					     
					    <span class="more-info"> - </span>
					     
					    <span class="more-info"><%= outbound.trips[i]['arrival-where-name'] %>, <%= outbound.trips[i]['arrival-where-code'] %> <br>
					    <%= outbound.trips[i]['arrival-when'].substr(0,10) %> <%= outbound.trips[i]['arrival-when'].substr(11,5) %></span>
					     
					     <br>
					    <p class="flight-nr">Flygbolag: <span class="going-bold"><%= outbound.trips[i]['airline'] %></span>, <%= outbound.trips[i]['flightnumber'] %></p>
					
				
					    <br>
					    
   					
   					<% }; %>
   					<span>Kommer fram: <%= dayOfOutboundArrival %> <%= outbound['arrival-when'].substr(0, 10) %></span>
				    
				    
			    </div>
			    <div class="modal-hemresa">
			    <h3>Hemresa</h3>
			   <span class="going-bold travel-header"> <%= inbound['departure-where-name'] %> - <%= inbound['arrival-where-name'] %></span>
			   <span class="date-header"><%= inbound['departure-when'].substr(0, 10) %></span>
			   <hr class="soften" style="margin:25px 0px;">
			   <span style="margin-bottom:10px;">Avgår: <%= dayOfInboundDeparture %> <%= inbound['departure-when'].substr(0, 10) %>	</span>
			   
			   		<!-- 		Loopar delresorna efter antalet totala stop		     -->
				    <% var nrStopsIn = parseInt(inbound['stops']) %>
				    <% for (var i=0;i<nrStopsIn+1;i++){ %>
	   				<% if(nrStopsIn != 0 ){ %>
	   					<p class="going-bold">Delresa <%= i + 1 %>: </p> 
	   				<% } else{ }%>
					    <p class="going-bold"><%= inbound.trips[i]['departure-where-name'] %> - <%= inbound.trips[i]['arrival-where-name'] %></p>
					    
					    
					    
					    <span class="more-info"><%= inbound.trips[i]['departure-where-name'] %>, <%= inbound.trips[i]['departure-where-code'] %> <br>
					     <%= inbound.trips[i]['departure-when'].substr(0,10) %> <%= inbound.trips[i]['departure-when'].substr(11,5) %></span> 
					     
					    <span class="more-info"> - </span>
					     
					    <span class="more-info"><%= inbound.trips[i]['arrival-where-name'] %>, <%= inbound.trips[i]['arrival-where-code'] %> <br>
					    <%= inbound.trips[i]['arrival-when'].substr(0,10) %> <%= inbound.trips[i]['arrival-when'].substr(11,5) %></span>
					     
					     <br>
					    <p class="flight-nr">Flygbolag: <span class="going-bold"><%= inbound.trips[i]['airline'] %></span>, <%= inbound.trips[i]['flightnumber'] %></p>
					
				
					    <br>
					    
   					<% }; %>
   					<span>Kommer fram: <%= dayOfInboundArrival %> <%= inbound['arrival-when'].substr(0, 10) %></span>
			    </div>
			  </div>
			  <div class="modal-footer">
			    <button class="btn" id="close-modal" >Stäng</button>
		</div>
		
		
	</div>
	
</script>

<script type="text/template" id="tpl-search-area">
	<div id="first-page" class="general-design" >
		
		<div class="span">
			<h1>Sök efter de bästa flygbiljetterna bland nätets resebyråer</h1>
			<div class="search-boxes-destination">
				  
				 <div class="pull-left departure-options">
						<label>Avreseort:</label>
						<input id="from" type="text" >
		
						<label>Avresedatum:</label>

					  	<div class="datepicker" id="datepicker-departure-date" >
						</div>
				</div>
				  
				<div class="pull-right arrival-options">
				  	 <label>Destination:</label>
				  	 <input id="to" type="text" >
				  	 <label id="label-to-return-date">Hemresedatum:</label>
				  	 <div class="datepicker" id="datepicker-return-date" style="display: block">

				     </div>
				</div>
				  
			</div>
			
		</div>
	
		 

		<!--
	  <div class="datepicker" id="datepicker-departure-date" >
			    <input type="text">
			  </div>
			 
			  <div class="datepicker" id="datepicker-return-date">
			    <input type="text">
			  </div>
			  -->
			  
	
		 
		 <div class="span"><div class="search-boxes-additional-info">	
		 
			<label class="checkbox">
			  <input type="checkbox" id="trip-type" value=""> Enkelresa
			</label>
		 
			<select id="number-adults">
			  <option value="0">0 Vuxen</option>
			  <option selected="selected" value="1">1 Vuxen</option>
			  <option value="2">2 Vuxna</option>
			  <option value="3">3 Vuxna</option>
			  <option value="4">4 Vuxna</option>
			  <option value="5">5 Vuxna</option>
			  <option value="6">6 Vuxna</option>
			  <option value="7">7 Vuxna</option>
			  <option value="8">8 Vuxna</option>
			  <option value="9">9 Vuxna</option>
			</select>
			<br>
			
			<select id="number-children">
			  <option value="0">0 Barn</option>
			  <option value="1">1 Barn</option>
			  <option value="2">2 Barn</option>
			  <option value="3">3 Barn</option>
			  <option value="4">4 Barn</option>
			  <option value="5">5 Barn</option>
			  <option value="6">6 Barn</option>
			  <option value="7">7 Barn</option>
			  <option value="8">8 Barn</option>
			  <option value="9">9 Barn</option>
			</select>		
		 
		 <button class="btn btn-large btn-primary" id="search-trip" type="button"><i class="icon-white icon-search"></i> Sök Flygbiljetter</button>
		 
		 </div>
	</div>   

</div>
</script>


<script type="text/template" id="tpl-trips">

	<ul id="search-results">
		
		
	</ul>

</script>


<script type="text/template" id="tpl-trip">
  <div>
    <div class="top">
      <div class="arrival-time">
      <span class="label-utresa">
	<img src="{{ STATIC_URL }}images/utresa.png"/>Utresa
      </span>
      <div>
		  <img style="height:40px;width:40px;" src="{{ STATIC_URL }}images/airlines/<%= airlineOutbound %>.jpg" />
		  <span><%= outbound_departure_time %> <%= outbound['departure-where-name'] %> - <%= outbound_arrival_time %> <%= outbound['arrival-where-name'] %>
			  <span class="arrival-time-travel">Restid: 
				  <span class="time">
					  <% if(outboundTripTime.hours) { %>
					  <%= outboundTripTime.hours %>h <%= outboundTripTime.minutes %>min
					  <% } else { %>
					  <%= outboundTripTime.minutes %>min
					  <% } %>
				  </span> 
			
							<% if(inbound['stops'] == "0") { %>
								<span style="color:green;display:inline;">(Direktflyg)</span>
								<% } else if(inbound['stops'] == "1") { %>
								(1 byte)
								<% } else { %>
								(<%= inbound['stops'] %> Byten)
								<% } %>
				      
							      <span style="display:inline;margin-left:10px;text-decoration:underline;font-size:10px;">
								<a class="flight-info-trigger">Flight info</a>
							      </span>
			  </span>
		  </span>
	</div>
      </div>
      <div class="departure-time">
      <span class="label-hemresa"><img src="{{ STATIC_URL }}images/hemresa.png"/>Hemresa</span>
      <div>
	<img  style="height:40px;width:40px;" src="{{ STATIC_URL }}images/airlines/<%= airlineInbound %>.jpg" />
	<span><%= inbound_departure_time %> <%= inbound['departure-where-name'] %> - <%= inbound_arrival_time %> <%= inbound['arrival-where-name'] %>
	  <span class="departure-time-travel">Restid: 
	    <span class="time">
	      <% if(inboundTripTime.hours) { %>
	      <%= inboundTripTime.hours %>h <%= inboundTripTime.minutes %>min
	      <% } else { %>
	      <%= inboundTripTime.minutes %>min
	      <% } %>      
	    </span> 
	    <% if(inbound['stops'] == "0") { %>
	    <span style="color:green;display:inline;">(Direktflyg)</span>
	    <% } else if(inbound['stops'] == "1") { %>
	    (1 byte)
	    <% } else { %>
	    (<%= inbound['stops'] %> Byten)
	    <% } %>
	    <span style="display:inline;margin-left:10px;text-decoration:underline;font-size:10px;">
	      <a  class="flight-info-trigger">Flight info</a>
	    </span>
	  </span>
	</span>
      </div>
      </div>

      <div class="lowest-price">
      	<span><%= total_price %> kr</span>
      	
      	<a href="<%= deeplink %>" class="btn btn-large btn-warning" target="_blank" >Gå till resa</a>
   
	</div>
    </div>
    <div class="bottom">
      <% _.each(prices, function(agency) { %>
      <div class="agency">
	<img src="{{ STATIC_URL }}images/travel-agencies/<%= agency.travel_agency %>.gif"/>
	<div><span><%= agency.price %> kr</span></div>
      </div>
      <% }); %>
    </div>
    <div class="modal-container"></div>
  </div>
</script>




<div class="row">
  <div class="span12 top-menu">
	  <a href="/"><img src="{{ STATIC_URL }}images/logo2.png" /> </a>
  </div>
</div>
<div class="row">
  <div class="span12" id="content">
  </div>
</div>

{% endblock %}
